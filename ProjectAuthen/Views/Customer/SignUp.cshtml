@model ProjectModelCommon.Model.CustomerUser

@{
    ViewBag.Title = "SignUp";
    Layout = "~/Views/Shared/_LayoutEmpty.cshtml";
}

<link href="~/Content/SignInAndUp/Signin.css" rel="stylesheet" />
<link href="~/Content/SignInAndUp/CommonStyle.css" rel="stylesheet" />
<script src="~/Content/assets/js/jsCheckInput.js"></script>

@*<div class="form-horizontal">
        @Html.AntiForgeryToken()
        <h4>CustomerUserModel</h4>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.LabelFor(model => model.Name, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.UserName, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.UserName, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.UserName, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.Password, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.PasswordFor(model => model.Password, new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.Password, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            @Html.LabelFor(model => model.Email, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Email, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Phone, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Phone, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Phone, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Avatar, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Avatar, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Avatar, "", new { @class = "text-danger" })
            </div>
        </div>



        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Đăng ký" class="btn btn-default btn-signup" />
            </div>
        </div>
    </div>*@

<div class="container-signin">
    @Html.AntiForgeryToken()
    <div class="form-signin">
        <span class="tile-signin">Đăng ký</span>
        <span class="error-text" style="color:red;display:flex;align-items: center;justify-content: center;"></span>

        <div class="form-group common-input" data-validate="Họ tên không hợp lệ">
            <label for="exampleInputEmail1">Họ tên</label>
            <input type="text" id="exampleInputEmail1" name="Name" placeholder="Họ tên">
            <span class="focus-input3 focus-input"></span>
        </div>
        <div class="form-group common-input" data-validate="Trùng tên đăng nhập">
            <label for="exampleInputEmail1">Tên đăng nhập</label>
            <input type="text" id="exampleInputEmail1" name="UserName" placeholder="Tên đăng nhập">
            <span class="focus-input1 focus-input"></span>
        </div>
        <div class="form-group common-input" data-validate="Mật khẩu không chính xác">
            <label for="exampleInputPassword1">Mật khẩu</label>
            <input type="password" id="exampleInputPassword1" name="Password" placeholder="Mật khẩu">
            <span class="focus-input2 focus-input"></span>
        </div>
        <div class="form-group common-input" data-validate="Mật khẩu không chính xác">
            <label for="exampleInputPassword1">Nhập lại mật khẩu</label>
            <input type="password" id="exampleInputPassword1" name="configPassword" placeholder="Nhập lại mật khẩu">
            <span class="focus-input2 focus-input"></span>
        </div>
        <div class="form-group common-input" data-validate="Email không hợp lệ">
            <label for="exampleInputEmail1">Địa chỉ email</label>
            <input type="text" id="exampleInputEmail1" name="Email" placeholder="Địa chỉ email">
            <span class="focus-input4 focus-input"></span>
        </div>
        <div class="form-group common-input" data-validate="Số điện thoại không hợp lệ">
            <label for="exampleInputEmail1">Số điện thoại</label>
            <input type="text" id="exampleInputEmail1" name="Phone" placeholder="Số điện thoại">
            <span class="focus-input5 focus-input"></span>
        </div>
        @*<div class="text-password">
            <a href="#" class="forgot-password">Quên mật khẩu</a>
        </div>*@
        <div class="form-buttom-signin">
            <button type="submit" class="btn btn-default btn-signup">ĐĂNG KÝ</button>
        </div>
        @*<div class="label-social">
            <p> hoặc sử dụng</p>
        </div>
        <div class="form-social">
            <a href="#" class="signin-face signin-social"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="signin-google signin-social"><i class="fab fa-google"></i></a>
        </div>*@
        <div class="label-social link-signup" style="margin-top: 35px;margin-bottom: 0px;">
            <a href="@Url.Action("signin","Customer")"> ĐĂNG NHẬP</a>
        </div>
    </div>
</div>
<div class="loading-page">
    <img src="~/Images/loading.gif" />
</div>

<script>
    $(function () {
        showhide();
        var addAntiForgeryToken = function (data) {
            data.__RequestVerificationToken = $("[name='__RequestVerificationToken']").val();
            return data;
        }; //addAntiForgeryToken
        $(".btn-signup").on("click", function () {
            let username = $("input[name='UserName']").val();
            let email = $("input[name='Email']").val();
            let phone = $("input[name='Phone']").val();
            let avatar = $("input[name='Avatar']").val();
            let name = $("input[name='Name']").val();
            let pass = $("input[name='Password']").val();
            if (validateSignUp(name, username, pass, email, phone) && validatePasswork(pass, $("input[name='configPassword']").val())) {
                $.ajax({
                    url: '/Customer/SignUp',
                    type: 'POST',
                    data: { __RequestVerificationToken: $("[name='__RequestVerificationToken']").val(), UserName: username, Email: email, Phone: phone, Avatar: avatar, Name: name, Password: pass },
                    async: true,
                    success: function (result) {
                        console.log(result);
                        if (!result) {
                            $(".error-text").text("Lỗi hệ thông");
                        } else {
                            window.history.back();
                        }
                        //$(".btn-footer-parent div:nth-child(1) span").text("(" + result.countArea + ")");//area
                        //$(".btn-footer-parent div:nth-child(2) span").text("(" + result.countProductNew + ")");//product new
                        //$(".btn-footer-parent div:nth-child(3) span").text("(" + result.countProductSelling + ")");//sell
                        //$(".btn-footer-parent div:nth-child(4) span").text("(" + result.countTrack + ")");//track
                        ////$(".btn-footer-parent div:nth-child(1)>span").
                        ////console.log(result);
                    },
                    error: function (error) {
                        console.log("ERROR:" + error);
                    }
                });
            }
        })
        /**
         * show hide loading*/
        function showhide() {
            $(".loading-page").toggle();
        }
        /**
         * validate signup
         */
        function validateSignUp(Name, UserName, Password, Email, Phone) {
            check = true;
            if (!validateText(Name, "", 5, 200)) {
                $("input[name='Name']").parents(".form-group").addClass("validate-input");
                check = false;
            }
            if (!validateText(UserName, "", 5, 200)) {
                $("input[name='UserName']").parents(".form-group").addClass("validate-input");
                check = false;
            }
            if (!validateText(Password, "", 5, 200)) {
                $("input[name='Password']").parents(".form-group").addClass("validate-input");
                check = false;
            }
            if (!validateText(Email, "email", 5, 200)) {
                $("input[name='Email']").parents(".form-group").addClass("validate-input");
                check = false;
            }
            if (!validateText(Phone, "phone", 9, 200)) {
                $("input[name='Phone']").parents(".form-group").addClass("validate-input");
                check = false;
            }
            return (check == true) ? true : false;
        }

        /**
         * validate passwork
         */
        function validatePasswork(passwork,configPasswork) {
            if (passwork != configPasswork) {
                $("input[name='configPassword']").parents(".form-group").addClass("validate-input");
                $("input[name='configPassword']").parents(".form-group").attr("data-validate", "Mật khẩu không trùng");
                return false;
            }
            return true;
        }
        $("input[name='Name'],input[name='UserName'],input[name='Password'],input[name='Email'],input[name='Phone']").on("focus", function () {
            $(this).parents(".form-group").removeClass("validate-input");
        })
    })
    
</script>
